<div ng-controller="quizzes.QuizEditController as vm"><form class="form-horizontal" id="quiz_form" name="quiz_form"><div class="row"><div class="col-lg-6"><div class="form-group"><div class="col-lg-4 col-xs-4 control-label"><label class="vhs-required">Subject</label></div><div class="col-sm-8 col-xs-8 pull-right"><div reference-dropdown-selector vhs-reference-name="'subjects'" vhs-model="vm.quiz" vhs-model-property="'subjectId'" vhs-element-name="subjectField" vhs-nullable="false" vhs-required="true" vhs-editable="true"/><span class="error" ng-show="quiz_form.subjectField.$error.required">Please specify a subject</span></div></div><div class="form-group"><label class="col-sm-4 col-xs-4 control-label vhs-required">Title</label><div class="col-sm-8 col-xs-8 pull-right"><input type="text" class="form-control" id="nameField" name="nameField" ng-model="vm.quiz.title" maxlength="255" required> <span class="error" ng-show="quiz_form.nameField.$error.required">Please specify a quiz title</span></div></div><div class="form-group"><label class="col-sm-4 col-xs-4 control-label">Thumbnail</label><div class="col-sm-8 col-xs-8 pull-right"><img class="img-preview" ngf-src="vm.preview" ngf-background="vm.preview"> <img class="img-preview" ngf-src="vm.quiz.previewUrl" ngf-background="vm.quiz.previewUrl" ng-if="vm.quizId && !vm.preview"><div class="input-group"><div class="fileUpload btn btn-block vhs-green vhs-white-text"><span>Upload</span> <input type="file" class="upload" ngf-select ng-model="vm.preview" ngf-pattern=".jpg,.png,.bmp" id="uploadPreviewField" name="uploadPreviewField"/></div></div><span class="error" ng-show="quiz_form.uploadPreviewField.$error.pattern">Invalid file format. Please select a file with .jpg, .png, or .bmp extension</span></div></div></div><div class="col-lg-6"><div class="form-group"><label class="col-lg-4 col-sm-5 col-xs-4 control-label vhs-required">Owner</label><div class="col-lg-8 col-sm-7 col-xs-8 pull-right"><select class="form-control" id="ownerField" name="ownerField" ng-model="vm.quiz.ownerId" ng-required="true" ng-options="::w.id as ::w.name for w in ::vm.owners"></select> <span class="error" ng-show="quiz_form.ownerField.$error.required">Please specify a quiz owner</span></div></div><div class="form-group"><label class="col-sm-4 col-xs-4 control-label vhs-required">Language</label><div class="col-sm-8 col-xs-8"><div reference-dropdown-selector vhs-reference-name="'languages'" vhs-model="vm.quiz" vhs-model-property="'languageId'" vhs-element-name="languageField" vhs-nullable="true" vhs-required="true" vhs-editable="true"/><span class="error" ng-show="quiz_form.languageField.$error.required">Please specify a language of the quiz</span></div></div><div class="form-group"><label class="col-sm-4 col-xs-5 control-label">Additional information</label><div class="col-sm-8 col-xs-8 pull-right"><textarea type="text" class="form-control" id="summaryField" name="summaryField" maxlength="2000" rows="3" ng-model="vm.quiz.summary"></textarea></div></div></div></div><div class="row quiz-container"><div class="col-lg-6"><h3 align="center">Add a question</h3><div class="form-group"><label class="col-sm-2 col-xs-2 control-label vhs-required">Question</label><div class="col-sm-10 col-xs-10 pull-right"><input type="text" class="form-control" id="questTextField" name="questTextField" ng-model="vm.currentQuestion.text" maxlength="1000"></div></div><div class="row"><div ng-repeat="answer in vm.currentAnswers"><div class="row"><div class="col-sm-3 col-xs-3 radio"><button class="btn btn-link" type="button" title="Up" ng-click="vm.moveUp($index, vm.currentAnswers)" ng-disabled="!vm.isMoveUp($index)"><span class="glyphicon glyphicon-arrow-up"></span></button> <button class="btn btn-link" type="button" title="Down" ng-click="vm.moveDown($index, vm.currentAnswers)" ng-disabled="!vm.isMoveDown($index, vm.currentAnswers)"><span class="glyphicon glyphicon-arrow-down"></span></button></div><div class="col-sm-7 col-xs-7"><div class="radio" ng-if="!vm.currentQuestion.isMultiple"><input type="radio" name="optradio" ng-model="answer.isCorrect" ng-value="true" ng-click="vm.checkCurrentCorrectAnswer(answer)"> <input type="text" class="form-control" id="answerTextField" name="answerTextField" ng-model="answer.text" maxlength="255"></div><div class="checkbox" ng-if="vm.currentQuestion.isMultiple"><input type="checkbox" ng-model="answer.isCorrect"> <input type="text" class="form-control" id="answerTextField" name="answerTextField" ng-model="answer.text" maxlength="255"></div></div><div class="col-sm-2 col-xs-2 radio"><button class="btn btn-default btn-sm" type="button" ng-click="vm.removeAnswerFromQuestion($index)"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button></div></div></div></div><div class="row"><div class="col-lg-12 button-with-margin"><button class="btn btn-default btn-sm" type="button" title="Add a new answer" ng-click="vm.addAnswerToQuestion()"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button></div></div><div class="form-group"><div class="checkbox"><label><input type="checkbox" ng-model="vm.currentQuestion.isMultiple" ng-click="vm.toggleQuestionMultiple()"> Enable multiple choice</label></div></div><div class="form-group col-xs-12"><label for="explanationField">Explanation</label><div vhs-rich-text-editor><div text-angular id="explanationField" name="explanationField" ta-max-text="2000" ng-model="vm.currentQuestion.explanation"></div></div><span class="error" ng-show="quiz_form.explanationField.$error.taMaxText">Maximum number of characters exceeded</span></div><div class="form-group"><label class="col-sm-8 col-xs-8 control-label text-left">Points for the correct answer</label><div class="col-sm-4 col-xs-4 pull-right"><input type="number" class="form-control" id="pointsField" name="pointsField" ng-model="vm.currentQuestion.points" max="1000" min="1"></div></div><div class="form-group"><div class="col-sm-4 col-xs-4"></div><div class="col-sm-8 col-xs-8"><div class="row form-btn-uploads"><div class="col-lg-6 col-xs-6"><button class="btn btn-block btn-xs vhs-green vhs-white-text" type="button" ng-click="vm.addQuestionToQuiz()" ng-disabled="!vm.currentQuestionValid() || vm.disabledSaveButton">Save</button></div><div class="col-lg-6 col-xs-6"><button class="btn btn-block btn-xs vhs-brown vhs-white-text" type="button" ng-click="vm.clearCurrentQuestionFields()">Reset</button></div></div></div></div></div><div class="col-lg-6"><h3 align="center">Preview</h3><div class="row search-scroll"><div ng-repeat="question in vm.quizQuestions" class="search-select"><div class="row"><div class="col-sm-3 col-xs-3"><button class="btn btn-link" type="button" title="Up" ng-click="vm.moveUp($index, vm.quizQuestions)" ng-disabled="!vm.isMoveUp($index)"><span class="glyphicon glyphicon-arrow-up"></span></button> <button class="btn btn-link" type="button" title="Down" ng-click="vm.moveDown($index, vm.quizQuestions)" ng-disabled="!vm.isMoveDown($index, vm.quizQuestions)"><span class="glyphicon glyphicon-arrow-down"></span></button></div><div class="col-sm-9 col-xs-9"><div class="row"><div class="col-sm-10 col-xs-10"><a href="javascript:void(0)" ng-click="vm.editQuestion($index, question)">{{$index + 1}}. {{question.text}} ({{question.points}} points of {{vm.getQuizPointsSum()}})</a></div><div class="col-sm-2 col-xs-2"><button class="btn btn-default btn-sm" type="button" ng-click="vm.removeQuestionFromQuiz($index)"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button></div></div><div class="row"><div class="col-sm-12 col-xs-12"><div ng-repeat="answer in question.answers"><div class="radio" ng-if="!question.isMultiple"><label><input type="radio" ng-model="answer.isCorrect" ng-value="true" disabled="disabled">{{answer.text}}</label></div><div class="checkbox" ng-if="question.isMultiple"><label><input type="checkbox" ng-model="answer.isCorrect" disabled="disabled">{{answer.text}}</label></div></div></div></div></div></div></div></div><div class="row search-select"><div class="form-group"><label class="col-sm-6 col-xs-6 control-label text-left">Time to pass the quiz</label><div class="col-sm-4 col-xs-4"><input type="number" class="form-control" id="durationField" name="durationField" ng-model="vm.quiz.duration" max="1000" min="1"></div><div class="col-sm-2 col-xs-2 control-label text-left"><span>minutes</span></div></div><div class="form-group"><label class="col-sm-12 col-xs-12">Quiz passed if</label><div class="row radio"><div class="col-sm-6 col-xs-8"><label><input type="radio" ng-model="vm.quiz.correctAnswersType" ng-value="'PERCENTAGE'"> % of correct answers is not less than</label></div><div class="col-sm-4 col-xs-2"><div class="input-group"><input type="number" class="form-control" ng-model="vm.percentageNumber" ng-disabled="vm.quiz.correctAnswersType != 'PERCENTAGE'" ng-required="vm.quiz.correctAnswersType == 'PERCENTAGE'" min="0" max="100"><div class="input-group-addon">%</div></div></div><div class="col-sm-2 col-xs-2"></div></div><div class="row radio"><div class="col-sm-6 col-xs-8"><label><input type="radio" ng-model="vm.quiz.correctAnswersType" ng-value="'POINTS'"> The total score is not less than</label></div><div class="col-sm-4 col-xs-2"><input type="number" class="form-control" ng-model="vm.pointsNumber" ng-disabled="vm.quiz.correctAnswersType != 'POINTS'" ng-required="vm.quiz.correctAnswersType == 'POINTS'" min="0" max="{{vm.getQuizPointsSum()}}"></div><div class="col-sm-2 col-xs-2"></div></div></div></div></div></div><div class="row quiz-container"><div class="col-lg-12"><div class="form-group" ng-if="vm.permissionsWithUsersAndGroups.length > 0"><div users-and-groups-selector vhs-object-model="vm" vhs-object-model-property="'quiz'" vhs-current-user-id-model="vm.quiz" vhs-current-user-id-model-property="'ownerId'" vhs-current-user-name-model="vm.quiz" vhs-current-user-name-model-property="'ownerName'" vhs-permissions-with-users-and-groups-model="vm.permissionsWithUsersAndGroups"></div></div></div><div class="col-lg-12"><div class="col-md-offset-4 col-sm-offset-2 col-xs-offset-2"><div class="col-md-3 col-sm-5 col-xs-5"><button class="btn btn-block vhs-green vhs-white-text" type="button" ng-click="vm.save()" ng-disabled="!quiz_form.$valid || vm.disabledSaveButton || vm.quizQuestions.length == 0">Save</button></div><div class="col-md-3 col-sm-5 col-xs-5"><a ng-href="#{{::vm.quizzesRouter.indexUrl()}}" class="btn btn-default btn-block">Cancel</a></div></div></div></div></form></div>