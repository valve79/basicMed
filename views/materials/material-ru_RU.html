<div ng-controller="materials.MaterialController as vm"><div class="col-lg-7 col-md-7 col-xs-7"><div ng-if="::vm.material.id"><div ng-if="::vm.isViewAllowed" ng-switch="vm.materialType"><div ng-if="vm.materialType == 'VIDEO' || vm.materialType == 'AUDIO'" vhs-thumbnail vhs-thumbnail-model="::vm.material"></div><div ng-switch-when="VIDEO" vhs-video vhs-sources="vm.multimediaSources" vhs-width="'100%'" vhs-height="'300px'" vhs-poster="vm.material.previewUrl" vhs-error-callback="vm.multimediaErrorCallback(code, message)"></div><div ng-switch-when="YOUTUBE" vhs-youtube-video vhs-sources="vm.multimediaSources" vhs-width="'100%'" vhs-height="'300px'" vhs-poster="vm.material.previewUrl" vhs-error-callback="vm.multimediaErrorCallback(code, message)"></div><div ng-switch-when="AUDIO" vhs-audio vhs-sources="vm.multimediaSources" vhs-width="'100%'" vhs-height="'300px'" vhs-poster="vm.material.previewUrl" vhs-error-callback="vm.multimediaErrorCallback(code, message)"></div><div ng-switch-when="DOCUMENTS" class="material-download"><div align="center"><a ng-href="{{::vm.material.downloadUrl}}" target="_blank" ng-click="vm.createMaterialDownloadActionLog(vm.material.id)"><img src="themes/default/img/download.png"> Скачать файл</a> <span ng-if="::vm.material.fileSize">({{ ::vm.material.fileSize | numeraljs:'0 b' }})</span></div></div><div ng-switch-when="PHOTO" class="material-download"><img ng-src="{{::vm.material.downloadUrl}}" width="100%" height="100%"></div><div ng-switch-when="LINK" class="material-download"><div align="center"><a ng-href="{{::vm.material.link}}" target="_blank"><img src="themes/default/img/redirect.png"> Перейти по ссылке</a></div></div></div><form ng-if="::vm.isMaterialEmpty" class="form-signin"><div class="alert alert-warning" role="alert"><p><span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span> <strong>Материал не загружен</strong></p><p>На данный момент просмотр и скачивание материала невозможно</p></div></form><form ng-if="::vm.isMaterialNotReady" class="form-signin"><div class="alert alert-warning" role="alert"><p><span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span> <strong>Материал находится на стадии обработки</strong></p><p>На данный момент просмотр и скачивание материала запрещено</p></div></form><div ng-if="!vm.material.permissions.view && vm.material.price > 0"><p><label>У Вас пока нет доступа к этому материалу, но Вы можете его приобрести.<br>Перейти на страницу заказа?</label></p><div class="col-lg-3 col-md-4 col-sm-5 col-xs-6"><a ng-href="#{{::vm.financeRouter.purchaseUrl(vm.material.id, 'MATERIAL')}}" class="btn btn-primary btn-block">Да</a></div><div class="col-lg-3 col-md-4 col-sm-5 col-xs-6"><button ng-click="vm.goBack()" type="button" class="btn btn-default btn-block">Нет</button></div><div><br><hr></div></div><div class="col-lg-12 col-md-12 col-xs-12 vhs-brown vhs-white-text material-name"><div class="col-lg-8 col-md-8 col-xs-6"><span ng-bind="::vm.material.title"></span></div><div class="col-lg-4 col-md-4 col-xs-6"><div class="pull-right"><button class="btn-transparent" type="button" ng-if="vm.isAuthenticated && !vm.material.favorite" ng-click="vm.addToFavorites()" title="Добавить в избранное"><span class="glyphicon glyphicon-star-empty"></span> <span class="sr-only">Добавить в избранное</span></button> <button class="btn-transparent" type="button" ng-if="vm.isAuthenticated && vm.material.favorite" ng-class="{'vhs-orange-text': vm.material.favorite}" ng-click="vm.removeFromFavorites()" title="Удалить из избранного"><span class="glyphicon glyphicon-star"></span> <span class="sr-only">Удалить из избранного</span></button> <button class="btn-transparent" ng-click="vm.changeMaterialRating(true)"><span class="glyphicon glyphicon-thumbs-up" ng-if="!vm.material.liked"></span> <span class="glyphicon glyphicon-thumbs-up vhs-green-text" ng-if="vm.material.liked"></span> <span class="label-thumbs" ng-class="{'vhs-green-text': vm.material.liked}">{{vm.material.likesCount}}</span></button> <button class="btn-transparent" ng-click="vm.changeMaterialRating(false)"><span class="glyphicon glyphicon-thumbs-down" ng-if="!vm.material.disliked"></span> <span class="glyphicon glyphicon-thumbs-down vhs-green-text" ng-if="vm.material.disliked"></span> <span class="label-thumbs" ng-class="{'vhs-green-text': vm.material.disliked}">{{vm.material.dislikesCount}}</span></button></div></div><div class="row" ng-if="vm.isAuthenticated"><div class="col-lg-4"><button ng-if="!vm.material.subscribe" class="btn btn-block btn-xs vhs-orange vhs-white-text" ng-click="vm.changeAuthorSubscription()">Подписаться</button> <button ng-if="vm.material.subscribe" class="btn btn-default btn-block btn-xs" ng-click="vm.changeAuthorSubscription()">Отменить подписку</button></div></div></div><div class="col-lg-12 col-md-12 col-xs-12 material-container"><div class="row" ng-if="vm.material.permissions.edit || vm.material.permissions.delete"><div class="col-lg-4" ng-if="vm.material.permissions.edit"><button class="btn btn-block btn-xs vhs-green vhs-white-text" ng-click="vm.editMaterial(vm.material)">Редактировать</button></div><div class="col-lg-4" ng-if="vm.material.permissions.delete"><button class="btn btn-block btn-xs vhs-brown vhs-white-text" ng-disabled="vm.disabledRemoveButton" ng-click="vm.deleteMaterial(vm.material)">Удалить</button></div></div><div class="row"><div class="col-lg-4 col-md-4 col-xs-4"><h6><strong>Предмет:</strong> <span ng-bind="::vm.material.subjectName"></span></h6><h6><strong>Название:</strong> <span ng-bind="::vm.material.title"></span></h6><h6><strong>Тема:</strong> <span ng-bind="::vm.material.topic"></span></h6><h6 ng-if="vm.material.author"><strong>Автор:</strong> <span ng-bind="::vm.material.author"></span></h6><h6><strong>Доступно до:</strong> <span ng-if="vm.material.id" ng-bind="(vm.material.validity)
                        ? vm.material.validity
                        : 'Бессрочно'
                        | date: 'dd.MM.yyyy'"></span></h6><h6><strong>Язык:</strong> <span ng-bind="::vm.material.languageName"></span></h6></div><div class="col-lg-8 col-md-8 col-xs-8"><h6 ng-if="vm.material.summary"><strong>Краткое содержание:</strong></h6><h6 ng-if="vm.material.summary"><span ng-bind="::vm.material.summary"></span></h6><h6 ng-if="vm.material.permissions.download && vm.material.typeId != 3 && vm.material.fileStatus == 'READY'"><strong>Ссылка для скачивания материала</strong> <a ng-href="{{::vm.material.downloadUrl}}" target="_blank" ng-click="vm.createMaterialDownloadActionLog(vm.material.id)">{{::vm.material.title}}</a> <span ng-if="::vm.material.fileSize">({{ ::vm.material.fileSize | numeraljs:'0 b' }})</span></h6></div></div></div><div class="col-lg-12 col-md-12 col-xs-12 material-container" ng-if="(vm.isAuthenticated && vm.systemPermissions && vm.systemPermissions.viewMaterialComment) || vm.material.permissions.addComment"><div vhs-grid data-grid-model-path="vm.commentsGridModel" data-vhs-grid-uuid="commentsRegisterGrid"><div ng-if="vm.systemPermissions.viewMaterialComment"><strong>Все комментарии {{vm.commentsCount}}</strong></div><div class="col-lg-12 col-md-12 col-xs-12 comment new-comment" ng-if="vm.systemPermissions && vm.systemPermissions.addMaterialComment || vm.material.permissions.addComment"><div class="media"><a class="pull-left" href="#"><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><label for="textareaField" class="sr-only">Новый комментарий</label> <textarea id="textareaField" class="form-control" maxlength="1000" ng-model="vm.newComment.text">
                                </textarea><div class="row"><div class="col-lg-12 col-md-12 col-xs-12"><button class="btn btn-xs btn-buy vhs-green vhs-white-text pull-right" type="button" ng-disabled="!vm.newComment.text.length" ng-click="vm.addComment(false, null)">Отправить</button> <button class="btn btn-xs btn-buy vhs-brown vhs-white-text pull-right" type="button" ng-click="vm.cleanComment()">Очистить</button></div></div></div></div></div><div ng-if="!vm.systemPermissions.viewMaterialComment"><div align="center"><p>Нет прав для просмотра комментариев</p></div></div><table class="table table-hierarchy" ng-if="vm.systemPermissions.viewMaterialComment"><tbody><tr ng-class="{'section': comment.level == 1}" ng-show="comment.visible" ng-repeat="comment in vm.commentsGridModel.entries" id="comment{{::comment.id}}"><td ng-class="{'lvl2': comment.level > 1}"><span ng-if="::(comment.level == 1 && comment.children.length > 0)"><span class="node-expanded" ng-show="comment.state === 'EXPANDED'" ng-click="comment.collapse()"></span> <span class="node-collapsed" ng-show="comment.state === 'COLLAPSED'" ng-click="comment.expandAll()"></span> </span><span><div class="media"><a class="pull-left" href=""><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><p class="media-heading"><span class="comment-name">{{::comment.comment.userName}}</span> <span class="comment-date"></span>{{::comment.comment.timestamp | date: 'dd.MM.yyyy HH:mm' }}</p><p>{{::comment.comment.text}}</p><div class="row col-lg-12 col-xs-12"><button class="btn btn-xs btn-transparent" ng-if="vm.systemPermissions && vm.systemPermissions.addMaterialComment" ng-click="vm.replyComment(comment.comment.id)">Ответить</button></div><div class="row comment-reply col-lg-12 col-xs-12"><div class="media" ng-if="comment.reply"><a class="pull-left" href="#"><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><textarea class="form-control" maxlength="1000" ng-model="vm.newReplyComment.text">
                                                    </textarea> <button class="btn btn-xs btn-buy vhs-green vhs-white-text pull-right" type="button" ng-disabled="!vm.newReplyComment.text.length" ng-click="vm.addComment(true, comment.comment.id)">Отправить</button> <button class="btn btn-xs btn-buy vhs-brown vhs-white-text pull-right" type="button" ng-click="comment.reply = false">Отменить</button></div></div></div></div></div></span></td></tr><tr vhs-grid-empty data-vhs-empty-message="Нет комментариев"></tr></tbody></table><div class="row" vhs-grid-pagination></div></div></div><div class="col-lg-12 col-md-12 col-xs-12 material-container" ng-if="!vm.isAuthenticated && !vm.material.permissions.addComment"><div align="center"><p>Авторизуйтесь, чтобы получить возможность оставлять комментарии</p><a class="btn btn-login-link" ng-click="vm.authRedirect.redirectToLogOn()">Войти</a></div></div></div></div><div class="col-lg-5 col-md-5 col-xs-5"><div class="col-lg-12 col-md-12 col-xs-12 vhs-brown vhs-white-text material-name"><div style="font-size: 16px">Похожий контент</div></div><div class="col-lg-12 col-md-12 col-xs-12 material-container" ng-repeat="material in ::vm.relatedMaterials"><a class="material-link" ng-href="#{{::vm.materialsRouter.watchUrl(material.id)}}"><div class="col-lg-6 col-md-6 col-xs-6"><div class="image-video"><img class="img-thumbnail" width="100%" height="100%" alt="{{::material.typeName}}" ng-src="{{::material.previewUrl}}" vhs-thumbnail vhs-thumbnail-model="material"><p><strong>{{::material.duration | numeraljs:'00:00:00'}}</strong></p></div></div><div class="col-lg-6 col-md-6 col-xs-6"><h6><strong>Предмет:</strong> {{::material.subjectName}}</h6><h6><strong>Название:</strong> {{::material.title}}</h6><h6><strong>Автор:</strong> {{material.author}}</h6></div></a></div></div></div>