<div ng-controller="materials.SearchController as vm"><div vhs-grid data-grid-model-path="vm.materialsGridModel" data-vhs-grid-uuid="materialsRegisterGrid"><div class="col-lg-3 col-xs-12"><form role="search" ng-submit="vm.searchMaterial()"><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == null}" ng-click="vm.filterMaterialViewType(null)">Все</button></div><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == 1}" ng-click="vm.filterMaterialViewType(1)">Популярные</button></div><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == 2}" ng-click="vm.filterMaterialViewType(2)">Новые</button></div><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == 3}" ng-click="vm.filterMaterialViewType(3)">Рекомендованные</button></div><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == 4}" ng-click="vm.filterMaterialViewType(4)">Скачанные</button></div><div class="form-group"><button class="btn btn-default btn-block btn-xs" type="button" ng-class="{'active': vm.viewType == 5}" ng-click="vm.filterMaterialViewType(5)">Купленные</button></div><h5 class="vhs-green-text">Поиск</h5><div class="form-group"><label for="searchString" class="sr-only">поиск материалов</label> <input id="searchString" type="text" class="form-control" ng-model="vm.materialsGridModel.filter.searchString"></div><h5 class="vhs-green-text">Расширенный поиск</h5><div class="form-group"><label for="ownerField" class="sr-only">Владелец</label> <select class="form-control" id="ownerField" name="ownerField" ng-model="vm.materialsGridModel.filter.ownerId" ng-options="w.id as w.name for w in vm.owners" select-placeholder><option value="">Владелец</option></select></div><div class="form-group"><div id="subjectField" reference-dropdown-selector vhs-reference-name="'subjects'" vhs-model="vm.materialsGridModel.filter" vhs-model-property="'subjectId'" vhs-placeholder="'Предмет'"/></div><div class="form-group"><label for="themeField" class="sr-only">Тема</label> <input id="themeField" type="text" class="form-control" placeholder="Тема" ng-model="vm.materialsGridModel.filter.topic"></div><div class="form-group"><div id="languageField" reference-dropdown-selector vhs-reference-name="'languages'" vhs-model="vm.materialsGridModel.filter" vhs-model-property="'languageId'" vhs-placeholder="'Язык'"/></div><div class="form-group"><div id="fileTypeField" reference-dropdown-selector vhs-reference-name="'fileTypes'" vhs-model="vm.materialsGridModel.filter" vhs-model-property="'fileType'" vhs-placeholder="'Тип'"/></div><h6>Дата загрузки</h6><div class="col-lg-6 col-xs-6 form-group-sm search-item"><label for="dateFromField" class="sr-only">с</label> <input id="dateFromField" date-picker type="text" size="10" class="form-control" maxlength="10" placeholder="с" ng-pattern="/^(0?[1-9]|[12][0-9]|3[01])\.(0?[1-9]|1[012])\.((18|19|20)\d{2})$/" ng-model="vm.materialsGridModel.filter.dateFromText"/></div><div class="col-lg-6 col-xs-6 form-group-sm search-item"><label for="dateToField" class="sr-only">по</label> <input id="dateToField" date-picker type="text" size="10" class="form-control" placeholder="по" ng-pattern="/^(0?[1-9]|[12][0-9]|3[01])\.(0?[1-9]|1[012])\.((18|19|20)\d{2})$/" maxlength="10" ng-model="vm.materialsGridModel.filter.dateToText"/></div><div class="col-lg-6 col-xs-6 form-group search-item"><button class="btn btn-block btn-xs vhs-green vhs-white-text" type="submit">Поиск</button></div><div class="col-lg-6 col-xs-6 form-group search-item"><button class="btn btn-block btn-xs vhs-brown vhs-white-text" type="button" ng-click="vm.clearSearch()">Очистить</button></div></form></div><div class="col-lg-9 col-xs-12" ng-cloak><div class="form-group row"><form class="form-inline"><div class="pull-right"><label for="viewTypeField" class="label-search">Просмотр</label> <select class="form-control" id="viewTypeField" ng-model="vm.searchViewType"><option value="0">список</option><option value="1">карточки</option></select></div></form></div><div class="form-group row" ng-if="vm.searchViewType == 0"><table class="table table-striped"><tr ng-if="vm.materialsGridModel.entries.length > 0"><th width="40%">Название</th><th width="20%">Тип</th><th width="15%">Продолжительность</th><th width="10%">Размер</th><th width="15%"></th></tr><tr ng-repeat-start="material in vm.materialsGridModel.entries" ng-click="vm.showDetails(material)" ng-class="{'selected-class-name': material.shown}"><td><a ng-href="{{::(material.permissions.view) ? '#' + vm.materialsRouter.watchUrl(material.id) : null}}" ng-click="::(material.permissions.view) ? null : vm.showPuchaseHint(material.id); $event.stopPropagation();">{{::material.subjectName}} / {{::material.topic}}</a></td><td><button class="btn-link" type="button" ng-click="vm.loadMaterialPage(material.id) ; $event.stopPropagation();"><span class="{{::vm.getMaterialTypeClass(material.typeId)}}"></span></button> <span>{{::vm.getMaterialTypeTitle(material.typeId)}}</span></td><td><span ng-if="material.typeId == 1 || material.typeId == 2">{{::material.duration | numeraljs:'00:00:00'}}</span></td><td>{{::material.fileSize | numeraljs:'0 b'}}</td><td><button type="button" id="button-purchase-{{::material.id}}" class="btn btn-xs btn-buy pull-right vhs-green vhs-white-text" ng-if="::material.price > 0 && !material.permissions.view" title="Цена {{::material.price}}" data-content="Если хотите приобрести этот материал, нажмите кнопку КУПИТЬ" data-placement="top" ng-click="vm.doPurchase(material.id)">КУПИТЬ</button></td></tr><tr ng-repeat-end="material in vm.materialsGridModel.entries" ng-show="material.shown"><td colspan="3"><div class="col-lg-12 col-xs-12"><div class="col-lg-1 col-xs-1"></div><div class="col-lg-10 col-xs-10"><div class="col-lg-6 col-xs-6"><div class="row"><b>Предмет:</b> {{::material.subjectName}}</div><div class="row"><b>Название:</b> {{::material.title}}</div><div class="row"><b>Тема:</b> {{::material.topic}}</div><div ng-if="material.author" class="row"><b>Автор:</b> {{::material.author}}</div><div class="row"><b>Доступно до:</b> <span ng-if="material.validity != null" ng-bind="::material.validity | date: 'dd.MM.yyyy'"></span> <span ng-if="material.validity == null">Бессрочно</span></div><div class="row"><b>Язык:</b> {{::material.languageName}}</div></div><div ng-if="material.summary" class="col-lg-6 col-xs-6"><b>Краткое содержание:</b> {{::material.summary}}</div></div><div class="col-lg-1 col-xs-1"></div></div></td></tr></table></div><div class="form-group row" ng-if="vm.searchViewType == 1"><div class="col-lg-4 col-xs-4" ng-repeat="material in vm.materialsGridModel.entries"><a class="material-link" ng-href="{{::(material.permissions.view) ? '#' + vm.materialsRouter.watchUrl(material.id) : null}}" ng-click="::(material.permissions.view) ? null : vm.showPuchaseHint(material.id)"><div class="search-result-element"><div class="image-video"><img class="img-rounded" width="100%" height="100%" alt="{{material.typeName}}" ng-src="{{::material.previewUrl}}" vhs-thumbnail vhs-thumbnail-model="material"><p ng-if="material.typeId == 1 || material.typeId == 2"><strong>{{::material.duration | numeraljs:'00:00:00'}}</strong></p></div><div class="element-info">Дата загрузки: {{::material.uploadDate | date: 'dd.MM.yyyy'}}</div><div class="element-title"><strong class="vhs-green-text">{{::material.subjectName}}</strong> <strong>/ {{::material.topic}}</strong></div><div class="element-info">{{::material.summary}}</div></div></a><div style="height: 32px"><button type="button" id="button-purchase-{{::material.id}}" class="btn btn-xs btn-buy pull-right vhs-green vhs-white-text" ng-if="::material.price > 0 && !material.permissions.view" title="Цена {{::material.price}}" data-content="Если хотите приобрести этот материал, нажмите кнопку КУПИТЬ" data-placement="top" ng-click="vm.doPurchase(material.id)">КУПИТЬ</button> <button class="btn btn-xs btn-transparent pull-right" type="button" ng-if="::material.permissions.view" ng-click="vm.loadMaterialPage(material.id)"><em>Подробнее</em></button></div></div></div><div vhs-grid-empty data-vhs-empty-message="Материалы не найдены"></div><div class="row"><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"><div class="pagination-block" vhs-grid-pagination></div></div></div></div></div></div>