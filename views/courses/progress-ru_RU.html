<div ng-controller="courses.CourseProgressController as vm"><div ng-include="'views/courses/_course-view-top-tabs-ru_RU.html'"></div><h4>Прогресс <span ng-if="(vm.selectedUserIds.length > 1 || vm.selectedGroupIds.length > 0) && !(vm.sectionsStatistics.length == 0)
    || (vm.selectedUserIds.length == 1) && !(vm.userProgress.length == 0)" class="glyphicon glyphicon-question-sign vhs-orange-text" aria-hidden="true" data-toggle="collapse" data-target="#infoField" aria-expanded="true" aria-controls="collapseExample"></span></h4><div ng-class="{'col-lg-9': vm.currentUserInOwners, 'col-lg-12': !vm.currentUserInOwners}"><div id="infoField" class="collapse"><div class="form-signin"><div class="alert alert-info" role="alert"><p><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <strong>Для просмотра детальной информации о прохождении курса нажмите на индикатор интересующего раздела</strong></p></div></div></div><div ng-if="vm.currentUserInOwners && vm.selectedUserIds.length == 0 && vm.selectedGroupIds.length == 0"><div class="form-signin"><div class="alert alert-info" role="alert"><p><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <strong>Выберите пользователей или группу для просмотра прогресса</strong></p></div></div></div><div ng-if="vm.currentUserInOwners && vm.selectedUserIds.length > 1 || vm.selectedGroupIds.length > 0"><ul class="vhs-progress-legend" ng-if="!(vm.sectionsStatistics.length == 0)"><li><span class="completed"></span>Все участники курса успешно прошли тест</li><li><span class="submitted"></span>Не все участники курса прошли тест или приступили к нему</li><li><span class="failed"></span>Никто из участников курса не сдал тест</li><li><span></span>Никто из участников курса не начал тест</li></ul><div class="vhs-progress"><span ng-repeat="sectionStatistics in vm.sectionsStatistics"><a href="" ng-click="vm.getSectionProgress(sectionStatistics)" class="circle" data-toggle="tooltip" tooltip title="{{sectionStatistics.sectionName}}" ng-class="{'submitted': sectionStatistics.status === 'SUBMITTED',
                             'completed': sectionStatistics.status === 'COMPLETED',
                             'failed': sectionStatistics.status === 'FAILED',
                             'sos': sectionStatistics.status === 'SOS',
                             'selected': sectionStatistics.sectionId === vm.selectedSectionStatistic.sectionId}"></a></span></div><div ng-if="vm.selectedSectionStatistic.sectionId" vhs-grid data-grid-model-path="vm.sectionProgressGridModel" data-vhs-grid-uuid="sectionProgressGridModel"><h5><strong>Раздел:</strong> <span>{{vm.selectedSectionStatistic.sectionName}}</span></h5><div class="form-inline form-header material-form-header" data-vhs-auto-search><label for="searchField" class="label-search">Всего записей: {{vm.sectionProgressGridModel.totalCount}}</label> <span class="glyphicon glyphicon-search" aria-hidden="true" data-toggle="collapse" data-target="#searchField" aria-expanded="false" aria-controls="collapseExample"></span> <input type="text" class="form-control collapse" id="searchField" maxlength="500" placeholder="Поиск" ng-model="vm.sectionProgressGridModel.filter.searchString"/> <button class="btn btn-sm pull-right glyphicon glyphicon-remove btn-add-section" ng-click="vm.cleanSelectedSection()"></button></div><div class="table-scroll"><table class="table table-hover table-striped" data-vhs-table><thead><tr><th>Пользователь</th><th>Статус секции</th></tr></thead><tbody><tr ng-repeat="progress in vm.sectionProgressGridModel.entries"><td>{{ progress.userName }}</td><td>{{ vm.getUserInSectionProgressStatus(progress.status) }}</td></tr><tr ng-if="vm.sectionProgressGridModel.entries.length == 0"><td colspan="2">Пользователи не найдены</td></tr></tbody></table></div><div vhs-grid-pagination></div></div><div class="form-signin" ng-if="vm.selectedGroupIds.length > 0 && vm.sectionsStatistics.length == 0"><div class="alert alert-info" role="alert"><p><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <strong>Прогресс выбранной группы не найден. Никто из участников группы не начал курс.</strong></p></div></div><div class="form-signin" ng-if="vm.selectedUserIds.length > 1 && vm.sectionsStatistics.length == 0"><div class="alert alert-info" role="alert"><p><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <strong>Прогресс выбранных пользователей не найден. Никто из пользователей не начал курс.</strong></p></div></div></div><div ng-if="!vm.currentUserInOwners || (vm.selectedUserIds.length == 1)"><ul class="vhs-progress-legend" ng-if="vm.userProgress.length > 0"><li><span></span>Не начато</li><li><span class="opened"></span>{{ vm.getUserInSectionProgressStatus("OPENED") }}</li><li><span class="submitted"></span>{{ vm.getUserInSectionProgressStatus("SUBMITTED") }}</li><li><span class="completed"></span>{{ vm.getUserInSectionProgressStatus("COMPLETED") }}</li><li><span class="failed"></span>{{ vm.getUserInSectionProgressStatus("FAILED") }}</li><li><span class="sos"></span>{{ vm.getUserInSectionProgressStatus("SOS") }}</li></ul><div class="vhs-progress"><span ng-repeat="module in vm.modules" class="rectangle-area"><span ng-repeat="section in vm.modulesSectionsMap.get(module.id)"><span ng-repeat="userSectionProgress in vm.userProgress | filter:{sectionId: section.id} as progressFilter"><span ng-click="vm.getUserProgressForQuiz(section)"><span data-toggle="tooltip" tooltip title="{{section.name}}" ng-class="{'circle': section.typeKey == 'QUIZ',
                                  'rectangle': section.typeKey != 'QUIZ',
                                  'opened': userSectionProgress.status === 'OPENED',
                                 'submitted': userSectionProgress.status === 'SUBMITTED',
                                 'completed': userSectionProgress.status === 'COMPLETED',
                                 'failed': userSectionProgress.status === 'FAILED',
                                 'sos': userSectionProgress.status === 'SOS',
                                 'selected': userSectionProgress.id === vm.selectedQuizProgress.id}"></span> </span></span><span ng-if="progressFilter.length == 0" ng-click="vm.getUserProgressForQuiz(section)"><span data-toggle="tooltip" tooltip title="{{section.name}}" ng-class="{'circle': section.typeKey == 'QUIZ',
                                  'rectangle': section.typeKey != 'QUIZ',
                                 'selected': section.id === vm.selectedQuizProgress.sectionId}"></span></span></span></span></div><div class="form-group" ng-if="vm.selectedQuizProgress.sectionId"><button class="btn btn-sm pull-right glyphicon glyphicon-remove btn-add-section" ng-click="vm.cleanSelectedSection()"></button><h5><strong>Раздел:</strong> <span>{{vm.selectedQuizProgress.sectionName}}</span></h5><h6><strong>Статус:</strong> <span>{{ vm.getUserInSectionProgressStatus(vm.selectedQuizProgress.status) }}</span></h6><h6 ng-if="vm.selectedQuizProgress.status === 'COMPLETED'"><span ng-if="vm.selectedQuizProgress.quizResultType === 'POINTS'"><strong>Набрано баллов:</strong> <span ng-bind="vm.selectedQuizProgress.quizResultPoints"></span> </span><span ng-if="vm.selectedQuizProgress.quizResultType === 'PERCENTAGE'" ng-bind="vm.selectedQuizProgress.quizResultPoints">%</span></h6></div><div class="form-signin" ng-if="vm.userProgress.length == 0"><div class="alert alert-info" role="alert"><p><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <strong>Прогресс выбранного пользователя по курсу не найден</strong></p></div></div></div></div><div class="col-lg-3" ng-if="vm.currentUserInOwners"><div class="search-view-type-item"><label for="viewTypeField" class="label-search">Поиск по</label> <select class="form-control" id="viewTypeField" ng-model="vm.searchType" ng-change="vm.changeFilter()"><option value="0">пользователям</option><option value="1">группам</option></select></div><div ng-if="vm.searchType == 0"><h3>Пользователи</h3><div class="broadcast-scroll-container"><table class="table"><tr ng-repeat="user in vm.courseUsers"><td ng-class="{'vhs-green vhs-white-text': user.selected}" ng-click="vm.getProgressForUser(user)">{{user.name}}</td></tr></table></div></div><div ng-if="vm.searchType == 1"><h3>Группы</h3><div class="broadcast-scroll-container"><table class="table"><tr ng-repeat="group in vm.courseGroups"><td ng-class="{'vhs-green vhs-white-text': group.selected}" ng-click="vm.getProgressForGroup(group)">{{group.name}}</td></tr></table></div></div></div></div>