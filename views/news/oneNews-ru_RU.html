<div ng-controller="news.OneNewsController as vm"><div class="news-container"><div class="col-lg-12 col-xs-12"><div class="row" ng-if="::vm.news.permissions.edit"><div class="col-lg-offset-10"><a class="btn btn-block btn-xs vhs-green vhs-white-text" ng-href="#{{::vm.newsRouter.oneNewsEditUrl(vm.newsId)}}">Редактировать</a></div></div><h3>{{::vm.news.title}}</h3></div><div class="col-lg-12 col-xs-12"><h6>Дата публикации {{::vm.news.publishDate | date: 'dd.MM.yyyy'}}</h6><h6>Автор {{::vm.news.author}}</h6></div><div class="col-lg-12 col-xs-12" align="justify"><div ta-bind ng-model="::vm.news.fullText" vhs-rich-text-bind></div></div><div class="col-lg-12 col-xs-12 news-comments" ng-if="vm.isAuthenticated && vm.systemPermissions && (vm.systemPermissions.viewNewsComment || vm.systemPermissions.addNewsComment)"><div vhs-grid data-grid-model-path="vm.commentsGridModel" data-vhs-grid-uuid="commentsNewsRegisterGrid"><div ng-if="vm.systemPermissions.viewNewsComment"><strong>Все комментарии {{vm.commentsCount}}</strong></div><div class="col-lg-12 col-md-12 col-xs-12 comment new-comment" ng-if="vm.systemPermissions.addNewsComment"><div class="media"><a class="pull-left" href="#"><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><label for="newCommentField" class="sr-only">Новый комментарий</label> <textarea id="newCommentField" class="form-control" maxlength="1000" ng-model="vm.newComment.text">
                           </textarea><div class="row"><div class="col-lg-12 col-md-12 col-xs-12"><button class="btn btn-xs btn-buy vhs-green vhs-white-text pull-right" type="button" ng-disabled="!vm.newComment.text.length" ng-click="vm.addComment(false, null)">Отправить</button> <button class="btn btn-xs btn-buy vhs-brown vhs-white-text pull-right" type="button" ng-click="vm.cleanComment()">Очистить</button></div></div></div></div></div><div ng-if="!vm.systemPermissions.viewNewsComment"><div align="center"><p>Нет прав для просмотра комментариев</p></div></div><table class="table table-hierarchy" ng-if="vm.systemPermissions.viewNewsComment"><tbody><tr ng-class="{'section': comment.level == 1}" ng-show="comment.visible" ng-repeat="comment in vm.commentsGridModel.entries" id="comment{{::comment.id}}"><td ng-class="{'lvl2': comment.level > 1}"><span ng-if="::(comment.level == 1 && comment.children.length > 0)"><span class="node-expanded" ng-show="comment.state === 'EXPANDED'" ng-click="comment.collapse()"></span> <span class="node-collapsed" ng-show="comment.state === 'COLLAPSED'" ng-click="comment.expandAll()"></span> </span><span><div class="media"><a class="pull-left" href=""><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><p class="media-heading"><span class="comment-name">{{::comment.comment.userName}}</span> <span class="comment-date"></span>{{::comment.comment.timestamp | date: 'dd.MM.yyyy HH:mm' }}</p><p>{{::comment.comment.text}}</p><div class="row col-lg-12 col-xs-12"><button class="btn btn-xs btn-transparent" ng-if="vm.systemPermissions && vm.systemPermissions.addNewsComment" ng-click="vm.replyComment(comment.comment.id)">Ответить</button></div><div class="row comment-reply col-lg-12 col-xs-12"><div class="media" ng-if="comment.reply"><a class="pull-left" href="#"><img class="media-object" src="themes/default/img/demo/photo.png" alt="Profile photo"></a><div class="media-body col-lg-10 col-xs-10"><textarea class="form-control" maxlength="1000" ng-model="vm.newReplyComment.text">
                                                    </textarea> <button class="btn btn-xs btn-buy vhs-green vhs-white-text pull-right" type="button" ng-disabled="!vm.newReplyComment.text.length" ng-click="vm.addComment(true, comment.comment.id)">Отправить</button> <button class="btn btn-xs btn-buy vhs-brown vhs-white-text pull-right" type="button" ng-click="comment.reply = false">Отменить</button></div></div></div></div></div></span></td></tr><tr vhs-grid-empty data-vhs-empty-message="Нет комментариев"></tr></tbody></table><div class="row" vhs-grid-pagination></div></div></div><div class="row"></div><div ng-if="!vm.isAuthenticated"><div class="row text-center">Авторизуйтесь, чтобы получить возможность оставлять комментарии</div><div class="row text-center"><a class="btn btn-login-link" ng-click="vm.authRedirect.redirectToLogOn()">Войти</a></div></div><legend></legend></div></div>